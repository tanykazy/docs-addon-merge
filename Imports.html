<script>
  /**
   * Run Google Apps Script function
   * @param {string} name - Function name
   * @param {...*} args - Arguments
   * @returns {Promise<*>} Promise
   */
  function googleScriptRun(name, ...args) {
    return new Promise(function (resolve, reject) {
      google.script.run
        .withSuccessHandler(function (response, userObject) {
          resolve(response, userObject);
        })
        .withFailureHandler(function (error, userObject) {
          console.debug(
            `The server-side function "${name}" throws an exception.`,
            error,
          );
          reject(error);
        })
        [name](...args);
    });
  }
</script>
